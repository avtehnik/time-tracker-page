<!DOCTYPE html>
<html>
<head>
  <title>Time tracker helper</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/bootstrap.min.css"/>
  <style>


      .form-control.task,
      .form-control.time {
          width: 80px;
      }

      .form-control.comment {
          width: 453px;
      }

      .form-control.time {
          width: 70px;
      }

      .container {
          margin-top: 100px;
      }
  </style>

</head>
<body>
<div id="vue-app" style="padding: 20px">
  <h1>Total {{totalTime}}h Remaining {{lastTime.last}} overtime {{lastTime.overtime}}</h1>
  <div class="row">
    <div class="col-md-7">

      <ul class="list-group">
        <li class="list-group-item">
          <div class="form-inline">
            <div class="form-group">
              <input type="date" class="form-control" v-model="taskDate" size="5" placeholder="task" @change="updateDate">
            </div>
            <div class="form-group">
              <button class="form-control" v-on:click="updateDate">Set Today</button>
            </div>
            <div class="form-group">
              <input type="text" class="form-control" v-model="task" size="10" placeholder="task">
            </div>
            <div class="form-group">
              <input type="number" class="form-control time" v-model="time" size="10" placeholder="time">
            </div>
            <div class="form-group">
              <input type="text" class="form-control" v-model="comment" placeholder="comment">
            </div>
            <button v-on:click="addRow()" class="btn btn-default">Add</button>
          </div>
        </li>
      </ul>

      <ul class="list-group">
        <li class="list-group-item" v-for="(timeItem, index) in timeSeries">
          <div class="form-inline">
            <div class="form-group">
              <input type="text" class="form-control " size="10" v-model="timeItem.date" placeholder="date">
            </div>
            <div class="form-group">
              <input type="text" class="form-control task" v-model="timeItem.task" placeholder="task">
            </div>
            <div class="form-group">
              <input type="number" class="form-control time" v-model="timeItem.time" placeholder="time">
            </div>
            <div class="form-group">
              <input type="text" class="form-control comment" v-model="timeItem.comment" placeholder="comment">
            </div>
            <div class="form-group">
              <button v-on:click="deleteItem(index)" class="btn btn-default">x</button>
            </div>
          </div>
        </li>
      </ul>
      <button v-on:click="save()" class="btn btn-default pull-right">Save</button>
      <br>
      <br>
      <br>
      <br>
      <h2>Common tasks editor</h2>
      <table class="table">
        <tr>
          <td>taskId</td>
          <td>time</td>
          <td>comment</td>
          <td>description</td>
          <td>
          </td>
        </tr>
        <tr v-for="(task, index ) in commonTasks">
          <td><a target="_blank" v-bind:href="'https://redmine.ekreative.com/issues/'+task.taskId">{{task.taskId}}</a></td>
          <td>{{task.time}}</td>
          <td>{{task.comment}}</td>
          <td>{{task.description}}</td>
          <td>
            <button class="btn btn-default" v-on:click="deleteCommonTask(index)">x</button>
          </td>
        </tr>
        <tr>
          <td><input type="number" class="form-control" v-model="commonTaskId" placeholder="task id"></td>
          <td><input type="number" class="form-control time" v-model="commonTaskTime" placeholder="time"></td>
          <td><input type="text" class="form-control" v-model="commonTaskComment" placeholder="comment"></td>
          <td><input type="text" class="form-control" v-model="commonTaskDescription" placeholder="description"></td>
          <td>
            <button v-on:click="addCommonTask()" class="btn btn-default">Add</button>
          </td>
        </tr>
      </table>


      <br>
      <br>
      apikey
      <input type="password" class="form-control" size="100" v-model="apiKey" @change="saveApiKey" placeholder="apikey">
    </div>
    <div class="col-md-5">

      <div>
        <h2>Common tasks</h2>
          <button v-for="task in commonTasks" v-on:click="addTask(task)" class="btn btn-default badge">{{task.description}} {{task.time}}h</button>

      </div>
      <h2>Last tasks</h2>
      <div v-for="(dayItem, dayNmae) in calendar" class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">{{dayNmae}} {{dayItem.reduce((accumulator, task) => accumulator + parseFloat(task.hours), 0)}} h</h3>
        </div>
        <div class="panel-body">

          <ul>
            <li v-for="task in dayItem" style="padding: 3px">
              <a target="_blank" v-bind:href="'https://redmine.ekreative.com/projects/'+task.project.id+'/issues'">{{task.project.name}}</a>

              (<a target="_blank" v-bind:href="'https://redmine.ekreative.com/issues/'+task.issue.id">{{task.issue.id}}</a>)
              <a target="_blank" v-bind:href="'https://redmine.ekreative.com/time_entries/'+task.id+'/edit'">{{task.hours}}h</a><br>
              {{task.comments}}
              <br>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="js/vue.js"></script>
<script src="js/jquery-3.5.1.min.js"></script>
<script src="js/app.js"></script>
</body>
</html>